import 'package:flutter/material.dart';

void main() {
  runApp(const OrderTrackingApp());
}

class OrderTrackingApp extends StatelessWidget {
  const OrderTrackingApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Order Tracking App',
      debugShowCheckedModeBanner: false,
      theme: ThemeData(
        colorScheme: ColorScheme.fromSeed(seedColor: Colors.teal),
        useMaterial3: true,
      ),
      initialRoute: '/',
      routes: {
        '/': (context) => const OrderListScreen(),
        '/details': (context) => const OrderDetailScreen(),
        '/track': (context) => const TrackOrderScreen(),
      },
    );
  }
}

// üè† Home Screen ‚Äì shows a list of orders
class OrderListScreen extends StatelessWidget {
  const OrderListScreen({super.key});

  final List<Map<String, String>> orders = const [
    {"orderId": "ORD1001", "item": "Smartphone", "status": "Shipped"},
    {"orderId": "ORD1002", "item": "Laptop", "status": "Processing"},
    {"orderId": "ORD1003", "item": "Wireless Earbuds", "status": "Delivered"},
    {"orderId": "ORD1004", "item": "Smartwatch", "status": "Out for Delivery"},
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text("Order Tracking"),
        backgroundColor: Colors.teal,
        foregroundColor: Colors.white,
      ),
      body: Padding(
        padding: const EdgeInsets.all(12.0),
        child: ListView.builder(
          itemCount: orders.length,
          itemBuilder: (context, index) {
            final order = orders[index];
            return Card(
              shape: RoundedRectangleBorder(
                borderRadius: BorderRadius.circular(15),
              ),
              elevation: 3,
              margin: const EdgeInsets.symmetric(vertical: 10),
              child: ListTile(
                title: Text(order["item"]!,
                    style: const TextStyle(
                        fontSize: 18, fontWeight: FontWeight.bold)),
                subtitle: Text("Order ID: ${order["orderId"]}"),
                trailing: ElevatedButton(
                  onPressed: () {
                    Navigator.pushNamed(context, '/details', arguments: order);
                  },
                  style: ElevatedButton.styleFrom(
                    backgroundColor: Colors.teal,
                    foregroundColor: Colors.white,
                  ),
                  child: const Text("View"),
                ),
              ),
            );
          },
        ),
      ),
    );
  }
}

// üì¶ Order Detail Screen
class OrderDetailScreen extends StatelessWidget {
  const OrderDetailScreen({super.key});

  @override
  Widget build(BuildContext context) {
    final order = ModalRoute.of(context)!.settings.arguments as Map<String, String>;

    return Scaffold(
      appBar: AppBar(
        title: Text("Order: ${order["orderId"]}"),
        backgroundColor: Colors.teal,
        foregroundColor: Colors.white,
      ),
      body: Padding(
        padding: const EdgeInsets.all(16.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(order["item"]!,
                style: const TextStyle(fontSize: 22, fontWeight: FontWeight.bold)),
            const SizedBox(height: 8),
            Text("Status: ${order["status"]!}", style: const TextStyle(fontSize: 16)),
            const SizedBox(height: 16),
            const Text(
              "Order Details:\nYour order is being processed and will be delivered soon. "
              "Track your order to see real-time updates.",
              style: TextStyle(fontSize: 15),
            ),
            const Spacer(),
            Center(
              child: ElevatedButton(
                onPressed: () {
                  Navigator.pushNamed(context, '/track', arguments: order);
                },
                style: ElevatedButton.styleFrom(
                  backgroundColor: Colors.teal,
                  foregroundColor: Colors.white,
                ),
                child: const Text("Track Order"),
              ),
            ),
          ],
        ),
      ),
    );
  }
}

// üöö Track Order Screen (Form + Progress)
class TrackOrderScreen extends StatefulWidget {
  const TrackOrderScreen({super.key});

  @override
  State<TrackOrderScreen> createState() => _TrackOrderScreenState();
}

class _TrackOrderScreenState extends State<TrackOrderScreen> {
  final _formKey = GlobalKey<FormState>();
  final _nameController = TextEditingController();
  final _emailController = TextEditingController();

  String currentStage = "Processing";

  final List<String> stages = [
    "Processing",
    "Shipped",
    "Out for Delivery",
    "Delivered"
  ];

  @override
  Widget build(BuildContext context) {
    final order = ModalRoute.of(context)!.settings.arguments as Map<String, String>;

    return Scaffold(
      appBar: AppBar(
        title: const Text("Track Your Order"),
        backgroundColor: Colors.teal,
        foregroundColor: Colors.white,
      ),
      body: Padding(
        padding: const EdgeInsets.all(16.0),
        child: Form(
          key: _formKey,
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Text("Order ID: ${order["orderId"]}",
                  style: const TextStyle(
                      fontSize: 18, fontWeight: FontWeight.bold)),
              const SizedBox(height: 8),
              Text("Item: ${order["item"]}", style: const TextStyle(fontSize: 16)),
              const Divider(height: 30),
              TextFormField(
                controller: _nameController,
                decoration: const InputDecoration(
                  labelText: "Full Name",
                  border: OutlineInputBorder(),
                ),
                validator: (value) =>
                    value == null || value.isEmpty ? "Enter your name" : null,
              ),
              const SizedBox(height: 12),
              TextFormField(
                controller: _emailController,
                decoration: const InputDecoration(
                  labelText: "Email",
                  border: OutlineInputBorder(),
                ),
                validator: (value) =>
                    value == null || !value.contains('@')
                        ? "Enter a valid email"
                        : null,
              ),
              const SizedBox(height: 16),
              Row(
                children: [
                  const Text("Current Status:",
                      style:
                          TextStyle(fontWeight: FontWeight.bold, fontSize: 16)),
                  const SizedBox(width: 10),
                  DropdownButton<String>(
                    value: currentStage,
                    items: stages
                        .map((stage) =>
                            DropdownMenuItem(value: stage, child: Text(stage)))
                        .toList(),
                    onChanged: (value) {
                      setState(() {
                        currentStage = value!;
                      });
                    },
                  ),
                ],
              ),
              const Spacer(),
              Center(
                child: ElevatedButton(
                  onPressed: () {
                    if (_formKey.currentState!.validate()) {
                      ScaffoldMessenger.of(context).showSnackBar(SnackBar(
                          content: Text(
                              "Tracking info for ${order["orderId"]} updated to '$currentStage'")));
                      Navigator.pop(context);
                    }
                  },
                  style: ElevatedButton.styleFrom(
                    backgroundColor: Colors.teal,
                    foregroundColor: Colors.white,
                    padding:
                        const EdgeInsets.symmetric(horizontal: 40, vertical: 12),
                  ),
                  child: const Text("Update & Back"),
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}
